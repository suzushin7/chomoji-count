javascript:(function(){if(window._chomojiCountActive)return;window._chomojiCountActive=true;const style=document.createElement("style");style.id="text-counter-style";style.textContent="#text-counter-popup{position:fixed;bottom:20px;right:20px;background-color:#333;color:white;padding:10px 15px;border-radius:5px;font-family:Arial,sans-serif;font-size:14px;z-index:9999;box-shadow:0 2px 10px rgba(0,0,0,0.2);display:none}#text-counter-popup.active{display:block}#text-counter-popup table{margin:0;border-collapse:collapse}#text-counter-popup td{padding:3px 8px}#text-counter-popup td:first-child{font-weight:bold;text-align:right}";document.head.appendChild(style);const popup=document.createElement("div");popup.id="text-counter-popup";popup.innerHTML="<table><tr><td>テキスト:</td><td id=\"text-only-count\">0</td></tr><tr><td>+改行:</td><td id=\"with-newlines-count\">0</td></tr><tr><td>+改行+空白:</td><td id=\"with-spaces-count\">0</td></tr></table>";document.body.appendChild(popup);function stripHtml(html){const tmp=document.createElement("div");tmp.innerHTML=html;return tmp.textContent||tmp.innerText||"";}function updateCount(){const selection=window.getSelection();if(selection.rangeCount>0){const range=selection.getRangeAt(0);const fragment=range.cloneContents();const div=document.createElement("div");div.appendChild(fragment);const plainText=stripHtml(div.innerHTML);const textOnly=plainText.replace(/[\n\r\t\f\v ]/g,"");const textWithNewlines=plainText.replace(/[ \t\f\v]/g,"");const textOnlyCount=textOnly.length;const withNewlinesCount=textWithNewlines.length;const withSpacesCount=plainText.length;document.getElementById("text-only-count").textContent=textOnlyCount;document.getElementById("with-newlines-count").textContent=withNewlinesCount;document.getElementById("with-spaces-count").textContent=withSpacesCount;popup.classList.add("active");}else{popup.classList.remove("active");}}document.addEventListener("mouseup",updateCount);document.addEventListener("keyup",function(e){const selectionKeys=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown","Shift","Control","Meta","Alt"];if(selectionKeys.includes(e.key)){updateCount();}});updateCount();})();
